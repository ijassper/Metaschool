{% extends 'base.html' %}
{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
    <h3 class="fw-bold"><i class="bi bi-list-task text-primary"></i> 창의적체험활동 목록</h3>
    <a href="{% url 'creative_create' %}" class="btn btn-primary shadow-sm">
        <i class="bi bi-plus-lg"></i> 새 활동 만들기
    </a>
</div>

<div class="card shadow-sm border-0">
    <div class="card-body p-0">
        <table class="table table-hover mb-0" style="vertical-align: middle;">
            <thead class="table-light">
                <tr>
                    <th class="text-center">번호</th>
                    <th>활동명</th>
                    <th>주제</th>
                    <th class="text-center">상태(On/Off)</th>
                    <th>생성일</th>
                    <th class="text-center">제출관리</th>
                    <th class="text-center">분석작업</th>
                    <th class="text-center">결과확인</th>
                </tr>
            </thead>
            <tbody>
                {% for activity in activities %}
                <tr>
                    <td class="text-center">{{ forloop.counter }}</td>
                    <td class="fw-bold">
                        <a href="{% url 'creative_detail' activity.id %}" class="text-decoration-none text-dark">
                            {{ activity.section }}
                        </a>
                    </td>
                    <td>{{ activity.title }}</td>
                    <!-- 2. 상태 토글 버튼 (클릭하면 즉시 시작/마감) -->
                    <td class="text-center">
                        <!-- 클릭 시 views.py의 toggle_activity_status 함수 호출 -->
                        <a href="{% url 'toggle_activity_status' activity.id %}" class="text-decoration-none">
                            {% if activity.is_active %}
                                <!-- 진행중일 때: 초록색 버튼 형태 -->
                                <span class="badge bg-success rounded-pill px-3 py-2 shadow-sm" style="cursor: pointer;">
                                    <i class="bi bi-play-fill"></i> 진행중
                                </span>
                            {% else %}
                                <!-- 대기중일 때: 회색 버튼 형태 (약간 투명하게) -->
                                <span class="badge bg-secondary rounded-pill px-3 py-2 opacity-75 shadow-sm" style="cursor: pointer;">
                                    <i class="bi bi-pause-fill"></i> 대기중
                                </span>
                            {% endif %}
                        </a>
                    </td>
                    <td>{{ activity.created_at|date:"Y-m-d" }}</td>
                    <td class="text-center">
                        <button class="btn btn-outline-primary btn-sm">제출 현황</button>
                    </td>
                    <td class="text-center">
                        <button class="btn btn-outline-success btn-sm"><i class="bi bi-robot"></i> AI 분석</button>
                    </td>
                    <td class="text-center">
                        <button class="btn btn-primary btn-sm">결과 분석</button>
                    </td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="8" class="text-center py-5 text-muted">등록된 활동이 없습니다.</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}